<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Nexo Custom Interior — 施工标准</title>
  <meta name="description" content="Nexo Custom Interior 施工标准图文库，支持手机临时标注（刷新后清除）。" />
  <style>
    :root{
      --bg:#0f172a; --panel:#0b1222; --card:#111827; --muted:#94a3b8; --text:#e5e7eb; --brand:#ff6b35;
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,"Noto Sans SC","PingFang SC",Arial,sans-serif;background:radial-gradient(1200px 800px at 70% -10%, #1f2937 0%, var(--bg) 60%);color:var(--text);min-height:100vh;display:flex;flex-direction:column}
    a{color:#ffd3c3}
    header{position:sticky;top:0;z-index:10;background:linear-gradient(180deg,rgba(15,23,42,.95),rgba(15,23,42,.75));backdrop-filter: blur(6px);border-bottom:1px solid #1f2937}
    .wrap{max-width:1100px;margin:0 auto;padding:14px 18px}
    .brand{display:flex;align-items:center;gap:12px}
    .logo{width:38px;height:38px;border-radius:12px;display:grid;place-items:center;background:conic-gradient(from 180deg,#ffedd5,#fecaca,#fde68a,#ffedd5);color:#111;font-weight:900}
    .brand h1{font-size:1.1rem;margin:0}
    .nav{margin-left:auto;display:flex;gap:10px}
    .nav a{background:#1e293b;color:#e5e7eb;text-decoration:none;padding:8px 12px;border-radius:8px}

    .panel{background:linear-gradient(180deg,rgba(255,255,255,.05),rgba(255,255,255,.03));border:1px solid rgba(255,255,255,.08);border-radius:16px;padding:14px}
    .grid{display:grid;grid-template-columns:280px 1fr;gap:16px}
    @media (max-width: 900px){.grid{grid-template-columns:1fr}}

    .sidebar{display:flex;flex-direction:column;gap:12px}
    .sidebar h3{margin:0 0 6px}
    .cats{display:grid;gap:8px}
    .cats button{background:#1e293b;color:#e5e7eb;border:1px solid rgba(255,255,255,.08);padding:10px 12px;text-align:left;border-radius:10px;cursor:pointer}
    .cats button.active{outline:2px solid rgba(255,107,53,.35);background:#243244}

    .viewer{display:flex;flex-direction:column;gap:10px}
    .toolbar{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
    .toolbar .btn{background:#fff;color:#111;font-weight:700;border:none;border-radius:8px;padding:8px 12px;cursor:pointer}
    .toolbar .btn.ghost{background:transparent;color:#e5e7eb;border:1px dashed rgba(255,255,255,.25)}
    .toolbar label{display:flex;align-items:center;gap:6px;background:#0b1222;border:1px solid rgba(255,255,255,.15);padding:8px 10px;border-radius:8px}

    .stage{position:relative;background:#0b1222;border:1px solid rgba(255,255,255,.1);border-radius:12px;overflow:hidden;min-height:300px}
    .stage img{display:block;max-width:100%;height:auto;margin:0 auto}
    canvas#sketch{position:absolute;inset:0;touch-action:none}

    .desc{background:#0b1222;border:1px solid rgba(255,255,255,.1);border-radius:12px;padding:12px;color:#cbd5e1}
    footer{margin-top:auto}
    footer .wrap{display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;color:#94a3b8}
  </style>
</head>
<body>
  <header>
    <div class="wrap brand">
      <div class="logo">NX</div>
      <h1>Nexo Custom Interior — 施工标准</h1>
      <nav class="nav">
        <a href="index.html">返回工作日志</a>
      </nav>
    </div>
  </header>

  <main class="wrap" style="padding:18px 18px 28px">
    <div class="grid">
      <!-- Sidebar: categories and image pickers -->
      <aside class="sidebar panel">
        <h3>类目</h3>
        <div class="cats" id="catList"></div>
        <div class="panel" style="margin-top:8px">
          <strong>当前图片</strong>
          <div id="imageList" style="margin-top:8px;display:grid;gap:6px"></div>
        </div>
        <div class="panel" style="margin-top:8px">
          <strong>如何上传照片？</strong>
          <ol style="margin:8px 0 0 18px;color:#cbd5e1">
            <li>把图片放到 <code>/assets/standards/类目名/</code> 目录（如 <code>assets/standards/踢脚线标准/</code>）。</li>
            <li>在下面的 <code>DATA</code> 配置里添加文件名数组（示例已给）。</li>
            <li>保存并刷新本页面即可看到新图片。</li>
          </ol>
        </div>
      </aside>

      <!-- Viewer -->
      <section class="viewer">
        <div class="toolbar">
          <button class="btn" id="prevBtn">上一张</button>
          <button class="btn" id="nextBtn">下一张</button>
          <button class="btn ghost" id="clearDraw">清除临时标注</button>
          <label>笔粗细<input id="size" type="range" min="2" max="20" value="6"></label>
          <label>笔颜色<input id="color" type="color" value="#ff6b35"></label>
        </div>
        <div class="stage" id="stage">
          <img id="photo" alt="标准示例" src=""/>
          <canvas id="sketch"></canvas>
        </div>
        <div class="desc" id="desc">选择左侧类目与图片进行查看。可在图片上临时绘画，刷新后自动清空。</div>
      </section>
    </div>
  </main>

  <footer>
    <div class="wrap">
      <small>© <span id="year"></span> Nexo Custom Interior</small>
      <small style="opacity:.8">临时标注不会保存；刷新即清除。</small>
    </div>
  </footer>

  <script>
    // ======== DATA（替换为你的真实文件名；保持目录结构） ========
    // 每个类目对应一个图片列表；文件放在 /assets/standards/{类目}/ 目录下
    const DATA = {
      "踢脚线标准": ["baseboard_01.jpg", "baseboard_02.jpg"],
      "门框标准":   ["doorframe_01.jpg"],
      "打胶标准":   ["caulk_01.jpg", "caulk_02.jpg"],
      "补洞标准":   ["patch_01.jpg"],
      "平整标准":   ["flatness_01.jpg"]
    };
    const BASE = "assets/standards/"; // 根目录

    // ======== DOM refs ========
    const catList = document.getElementById('catList');
    const imageList = document.getElementById('imageList');
    const img = document.getElementById('photo');
    const desc = document.getElementById('desc');
    const stage = document.getElementById('stage');
    const canvas = document.getElementById('sketch');
    const ctx = canvas.getContext('2d');

    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');
    const clearBtn = document.getElementById('clearDraw');
    const size = document.getElementById('size');
    const color = document.getElementById('color');

    let currentCat = Object.keys(DATA)[0] || null;
    let currentIndex = 0;

    // ======== Init ========
    document.getElementById('year').textContent = new Date().getFullYear();
    buildCats();
    if(currentCat){ loadCat(currentCat); }
    window.addEventListener('resize', fitCanvas);

    function buildCats(){
      catList.innerHTML = '';
      Object.keys(DATA).forEach(cat => {
        const btn = document.createElement('button');
        btn.textContent = cat;
        btn.className = 'cat';
        btn.addEventListener('click', ()=> loadCat(cat));
        catList.appendChild(btn);
      });
    }

    function loadCat(cat){
      currentCat = cat; currentIndex = 0;
      [...catList.children].forEach(b=> b.classList.toggle('active', b.textContent===cat));
      renderImageList();
      showImage();
    }

    function renderImageList(){
      imageList.innerHTML = '';
      (DATA[currentCat]||[]).forEach((file, i)=>{
        const a = document.createElement('a');
        a.href = '#'; a.textContent = file; a.style.textDecoration='none'; a.style.color='#cbd5e1';
        a.addEventListener('click', (e)=>{ e.preventDefault(); currentIndex = i; showImage(); });
        imageList.appendChild(a);
      });
    }

    function showImage(){
      const file = (DATA[currentCat]||[])[currentIndex];
      if(!file){ img.removeAttribute('src'); desc.textContent = '该类目暂无图片。'; return; }
      const src = `${BASE}${currentCat}/${file}`;
      img.src = src;
      desc.textContent = `${currentCat} · ${file}`;
      // 清空画布
      ctx.clearRect(0,0,canvas.width, canvas.height);
      // 等待图片尺寸就绪后适配画布
      img.onload = fitCanvas;
    }

    function fitCanvas(){
      // 让画布铺满 stage 同尺寸（与图片显示尺寸一致）
      const rect = stage.getBoundingClientRect();
      canvas.width = rect.width; canvas.height = rect.height;
      // 清空（刷新后也会清空）
      ctx.clearRect(0,0,canvas.width, canvas.height);
    }

    // ======== Drawing（临时） ========
    let drawing = false; let last = null;
    function startDraw(x,y){ drawing = true; last = {x,y}; }
    function moveDraw(x,y){
      if(!drawing) return;
      ctx.lineCap = 'round'; ctx.lineJoin = 'round';
      ctx.strokeStyle = color.value; ctx.lineWidth = +size.value;
      ctx.beginPath(); ctx.moveTo(last.x,last.y); ctx.lineTo(x,y); ctx.stroke();
      last = {x,y};
    }
    function endDraw(){ drawing = false; last = null; }

    // Mouse
    canvas.addEventListener('mousedown', e=> startDraw(e.offsetX, e.offsetY));
    canvas.addEventListener('mousemove', e=> moveDraw(e.offsetX, e.offsetY));
    window.addEventListener('mouseup', endDraw);

    // Touch（相对 canvas 定位）
    canvas.addEventListener('touchstart', e=>{
      const t = e.changedTouches[0];
      const r = canvas.getBoundingClientRect();
      startDraw(t.clientX - r.left, t.clientY - r.top);
      e.preventDefault();
    }, {passive:false});
    canvas.addEventListener('touchmove', e=>{
      const t = e.changedTouches[0]; const r = canvas.getBoundingClientRect();
      moveDraw(t.clientX - r.left, t.clientY - r.top);
      e.preventDefault();
    }, {passive:false});
    canvas.addEventListener('touchend', endDraw);

    clearBtn.addEventListener('click', ()=> ctx.clearRect(0,0,canvas.width, canvas.height));
    prevBtn.addEventListener('click', ()=>{ currentIndex = (currentIndex - 1 + DATA[currentCat].length) % DATA[currentCat].length; showImage(); });
    nextBtn.addEventListener('click', ()=>{ currentIndex = (currentIndex + 1) % DATA[currentCat].length; showImage(); });
  </script>
</body>
</html>
